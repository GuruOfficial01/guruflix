<script>
  // ==== SETTINGS ====
  const TMDB_API_KEY = "YOUR_TMDB_API_KEY"; // इथे तुझी key
  const TMDB_BASE = "https://api.themoviedb.org/3";
  const TMDB_IMG = "https://image.tmdb.org/t/p/w500";

  const grid = document.getElementById("moviesGrid");
  const filterChips = document.querySelectorAll(".chip[data-filter]");

  // TMDB URL वेगवेगळ्या filters साठी
  function getUrl(filter) {
    switch (filter) {
      case "popular":
        return `${TMDB_BASE}/movie/popular?api_key=${TMDB_API_KEY}&language=en-IN&page=1`;
      case "trending":
        return `${TMDB_BASE}/trending/movie/week?api_key=${TMDB_API_KEY}&language=en-IN`;
      case "marathi":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_original_language=mr&sort_by=popularity.desc&page=1`;
      case "hindi":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_original_language=hi&sort_by=popularity.desc&page=1`;
      case "south":
        // Telugu + Tamil + Malayalam mix
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_original_language=te,ta,ml&sort_by=popularity.desc&page=1`;
      case "action":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_genres=28&sort_by=popularity.desc&page=1`;
      case "drama":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_genres=18&sort_by=popularity.desc&page=1`;
      case "romance":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_genres=10749&sort_by=popularity.desc&page=1`;
      case "crime":
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&with_genres=80&sort_by=popularity.desc&page=1`;
      case "all":
      default:
        return `${TMDB_BASE}/discover/movie?api_key=${TMDB_API_KEY}&sort_by=popularity.desc&page=1`;
    }
  }

  // Card HTML तयार करणारी function
  function createCard(movie) {
    const poster = movie.poster_path
      ? `${TMDB_IMG}${movie.poster_path}`
      : "https://via.placeholder.com/500x750?text=No+Image";
    const year = movie.release_date ? movie.release_date.slice(0, 4) : "----";
    const rating = movie.vote_average ? movie.vote_average.toFixed(1) : "--";
    const title = movie.title || movie.name || "Untitled";

    return `
      <article class="card">
        <div class="poster">
          <div class="poster-chip">${year}</div>
          <img src="${poster}" alt="${title}" class="poster-img" loading="lazy" />
          <div class="poster-rating">★ ${rating}</div>
        </div>
        <div class="body">
          <div class="title" title="${title}">${title}</div>
          <div class="meta-row">
            <span>${year} · ${movie.original_language?.toUpperCase() || "N/A"}</span>
            <span class="tag">TMDB</span>
          </div>
        </div>
      </article>
    `;
  }

  // Movies load करणारी function
  async function loadMovies(filter = "all") {
    try {
      grid.innerHTML = "<p style='grid-column: 1 / -1; padding:8px; color:#9ca3af;'>Loading…</p>";
      const url = getUrl(filter);
      const res = await fetch(url);
      const data = await res.json();

      if (!data.results || !data.results.length) {
        grid.innerHTML = "<p style='grid-column: 1 / -1; padding:8px; color:#9ca3af;'>No movies found.</p>";
        return;
      }

      grid.innerHTML = data.results
        .slice(0, 20)     // जास्त movies नको असतील तर limit
        .map(createCard)
        .join("");
    } catch (err) {
      console.error(err);
      grid.innerHTML = "<p style='grid-column: 1 / -1; padding:8px; color:#f87171;'>Error loading movies.</p>";
    }
  }

  // Filters click events
  filterChips.forEach(chip => {
    chip.addEventListener("click", () => {
      // active class बदल
      filterChips.forEach(c => c.classList.remove("active"));
      chip.classList.add("active");

      const filter = chip.getAttribute("data-filter");
      loadMovies(filter);
    });
  });

  // Page load झाल्यावर All movies
  loadMovies("all");
</script>
